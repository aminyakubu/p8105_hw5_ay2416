---
title: "Homework 5"
author: "Amin Yakubu"
date: "11/6/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

### Problem 1 

Unzipping the file and 
```{r}
plyr::ldply(.data = "./data/hw5_data.zip", .fun = unzip)

```

Extracting the filepaths and names into lists
```{r}
filepaths = list.files("./data", pattern = "*.csv", full.names = TRUE)

filenames = basename(filepaths)
```

Writing function to read the data

```{r}
read_fx = function(data, name){
  
  list(read_csv(file = data) %>% mutate(id = name))
  
}

```

Now iterating using `map` function to read all the csv files and bind them together

```{r}
x = purrr::map2(filepaths, filenames, read_fx)

df = purrr::map_df(x, bind_rows)

tidy_data = df %>%
  gather(key = week, value = value, week_1:week_8) %>% 
  mutate(id = str_replace(id, ".csv",""),
         week = as.numeric(str_replace(week, "week_", ""))) %>% 
  separate(id, into = c("group", "id"), sep = "_") %>% 
  mutate(id = as.factor(id))

ggplot(tidy_data, aes(x = week, y = value, color = id, group = id)) + geom_point() + geom_line() + facet_grid(~group) 
```


Problem 2

```{r}
hom_df = read_csv("data/homicide-data.csv", col_names = TRUE) %>% 
  mutate(city_state = str_c(city, ",", " ", state))
```

Describe dataset ---

Summary statistics

Summarize within cities to obtain the total number of homicides and the number of unsolved homicides (those for which the disposition is “Closed without arrest” or “Open/No arrest”).

```{r}

```


















